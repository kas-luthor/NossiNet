
{% extends "layout.html" %}
{% macro dots(val,max=5) -%}
    {% if val is not defined%}
        {% set val = 0 %}
    {% endif %}
    {% for i in range(val) -%}
        ●
    {%- endfor -%}
    {%- for i in range(max-val) -%}
        ○
    {%- endfor %}
{%- endmacro %}
{% macro catformat(cat, name) -%}
    <br/>
    <table style = "width: 100%">
        {%-set l = [0] %}
        {% for k,v in cat.items()  -%}
            {% if l[0]==0 %}
                {% if v.items()|length > 0  %}
                    <tr>
                        <td colspan="2" style="text-align: center;" class="leeet">{{ name }}</td>
                    </tr>
                    {%- if l.insert(0, l[0] + 1) -%}{% endif %}
                {% endif %}

            {% endif %}
        {% endfor %}
        {% for k,v in cat.items() -%}
            {% if v.items()|length > 0 %}
                <tr>
                    <td colspan="2" style="text-align: center;" class="leet">{{ k }}</td>
                </tr>
                {% for vk,vv in v.items() -%}
                    <tr>
                        <td style="text-align: left; word-wrap: break-word">{{ vk }} </td>
                        <td>{{ dots(vv) }} </td>
                    </tr>
                {% endfor %}
                <tr><td><br></td></tr>
            {% endif %}
        {%- endfor -%}
    </table>
{%- endmacro %}
{% block title %}
    {%- if character.Name -%}
        <title>{{ character.Name }}</title>
    {%- else -%}
        <title>Charactersheet</title>
    {%- endif -%}
{% endblock %}

{% block body %}


<table width="100%" class="leet dividedtable" border="1">
    <tr>
        <td colspan="6" style="text-align: center; font-size: 1.5em" class="leeet">
            {%- if character.Name -%}
                Charactersheet&nbspfor&nbsp{{ character.Name }}
            {%- else -%}
                Charactersheet&nbspfor&nbspUnnamed&nbspCharacter
            {%- endif -%}</td>
    </tr>
    <tr>
        <td style="text-align: right; ">Name:</td>
        <td style="text-align: left; ">{{ character.Name }}</td>
        <td style="text-align: right; ">Spezies:</td>
        <td style="text-align: left; ">{{ character.Meta.Spezies }}</td>
        <td style="text-align: right; ">XP:</td>
        <td style="text-align: left; ">{{ character.Meta.xp }}</td>
    </tr>
    <tr>
        <td style="text-align: right; ">Spieler:</td>
        <td style="text-align: left; ">{{ character.Meta.Player }}</td>
        <td style="text-align: right; ">Größe:</td>
        <td style="text-align: left; ">{{ character.Meta.Demeanor }}</td>
        <td style="text-align: right; ">Heimat:</td>
        <td style="white-space: nowrap; text-align: left; ">{{ character.Meta.Haven }}</td>
    <tr>
        <td style="text-align: right; overflow: hidden; width: 1px; ">Story:</td>
        <td style="text-align: left; ">{{ character.Meta.Chronicle }}</td>
        <td style="text-align: right; ">Gewicht:</td>
        <td style="text-align: left; ">{{ character.Meta.Clan }}</td>
        <td style="text-align: right; ">Konzept:</td>
        <td style="white-space: nowrap; text-align: left; ">{{ character.Meta.Concept }}</td>
    </tr>
</table>
<br>
<div style="text-align: center ">
    {% for category,data in character.Categories.items() %}
        <div style="display: inline-block; vertical-align: top;">{{ catformat(data,category)}}</div>
    {% endfor %}
</div>
{% if own %}
<form action="{{ url_for('modify_sheet') }}" >
    <input type="submit" class="leet bigbtn" value="EDIT">
</form>
{% endif %}

{% endblock %}