{% extends "layout.html" %}
{% block head %}
    <link rel="stylesheet" type=text/css  href="/static/map.css">
    <script>
        function plzIn() {

        }
        function plzOut() {

        }

    window.onload= function() {
        $(function() {
            $("#loadedmap").load("/static/berlinPLZ.svg", function () {
                document.getElementById("page_complete").style.minWidth="60em";

                var map = document.getElementById("svg");
                var plzs=$(".plz");
                plzs.hover(plzIn, plzOut);
                $.getJSON("{{ url_for("mapdata") }}","",function(mapdata){

                    plzs.each(function () {
                        var desc = document.createElementNS("http://www.w3.org/2000/svg","title");
                        var name = this.id.slice(4);
                        var node = document.createTextNode('PLZ: ' + name +
                            '\nOwner: ' + mapdata[name]['owner'] +
                            '\nTags: ' + mapdata[name]['tags'] +
                            '\nData: ' + mapdata[name]['data'] );
                        $(this).attr("tags", mapdata[name]['tags'] );
                        desc.appendChild(node);
                        this.appendChild(desc);
                        var text = document.createElementNS("http://www.w3.org/2000/svg","text");
                        var plz = document.createTextNode(this.id.slice(4));
                        text.appendChild(plz);
                        text.setAttribute("x", this.getBBox().x+this.getBBox().width/2 -15);
                        text.setAttribute("y", this.getBBox().y+this.getBBox().height/2);
                        text.setAttribute("style", "fill:#040444");
                        text.setAttribute("class", "svgtext");
                        map.appendChild(text);
                    });
                });
                $("#VentrueButton").click(function(){
                    $("path").each(function () {
                        if (this.getAttribute("tags")) {
                            if (this.getAttribute("tags").includes("Ventrue")) {
                                $(this).addClass("Ventrue");
                            }
                        }
                    });
                });
                $("#ClearButton").click(function(){
                    $("path").each(function () {
                        if (this.getAttribute("tags")) {
                            if (this.getAttribute("tags").includes("Ventrue")) {
                                $(this).removeClass(this.getAttribute("tags"));
                            }
                        }
                    });
                });

            });
        });
    };



    </script>
{% endblock %}
{% block body %}
    <div id="VentrueButton" >Ventrue</div>
    <div id="ClearButton" >Clear</div>
    <div id="loadedmap" style="
    left:0;
    right:0;
    width: 100%"></div>
    <div id="map"></div>




{% endblock %}